screenlay:

#:set norm (0.4,0.4,0.4,1)

<Button>:
    color:1,1,1,1
    canvas.before:
        Color:
            rgb:(0.7,0.7,0.7,1) if self.state=="down" else norm
        RoundedRectangle:
            pos:(self.center_x-(self.width/2.34),self.center_y-(self.height/2.4)) if self.state=="down" else (self.center_x-(self.width/2.1),self.center_y-(self.height/2.3))
            size:(self.width/1.1,self.height/1.15) if self.state=="normal" else (self.width/1.2,self.height/1.25) 
            radius:[30]
    background_color: 0,0,0,0
    font_size:"40dp" if self.state=="normal" else "30dp"

<screenlay>:
    orientation:"vertical"
    canvas:
        Color: 
            rgb:(.2,.2,.2,1)
        Rectangle:
            size:self.size
    TextInput:
        id:textforin
        text:root.textout
        input_filter: lambda text, from_undo:''.join(ch for ch in text if ch in "0123456789./+-=x")           
        multiline:False
        hint_text:"0"
        on_text:root.textinputted(self.text)
        on_text_validate:self.text+='='
        disabled:root.is_disabled
        foreground_color:1,1,1,1
        background_color:.2,.2,.2,1
        border_color:.2,.2,.2,1
        cursor_color:0,1,.3,1
        font_size:"60dp"
        halign: "center"
        on_cursor:
            root.cursorloc(self.cursor)
        cursor_width:"3dp"
        padding_y:self.height/3.5
    GridLayout:
        cols:4
        Button:
            id:sym
            text:"C"
            canvas.before:
                Color:
                    rgb:(1, 0.784, 0.4, 1) if self.state=="down" else (1, 0.639, 0, 1)
                RoundedRectangle:
                    pos:(self.center_x-(self.width/2.34),self.center_y-(self.height/2.4)) if self.state=="down" else (self.center_x-(self.width/2.1),self.center_y-(self.height/2.3))
                    size:(self.width/1.1,self.height/1.15) if self.state=="normal" else (self.width/1.2,self.height/1.25) 
                    radius:[30]
            on_press:
                root.forclear()
        Button:
            id:sym
            text:"("
            canvas.before:
                Color:
                    rgb:norm if self.state=="down" else (0.7,0.7,0.7,1)
                RoundedRectangle:
                    pos:(self.center_x-(self.width/2.34),self.center_y-(self.height/2.4)) if self.state=="down" else (self.center_x-(self.width/2.1),self.center_y-(self.height/2.3))
                    size:(self.width/1.1,self.height/1.15) if self.state=="normal" else (self.width/1.2,self.height/1.25) 
                    radius:[30]
            on_press:
                root.textbedisplay(self.text)  
            disabled:root.is_disabled   
        Button:
            id:sym
            text:")"
            canvas.before:
                Color:
                    rgb:norm if self.state=="down" else (0.7,0.7,0.7,1)
                RoundedRectangle:
                    pos:(self.center_x-(self.width/2.34),self.center_y-(self.height/2.4)) if self.state=="down" else (self.center_x-(self.width/2.1),self.center_y-(self.height/2.3))
                    size:(self.width/1.1,self.height/1.15) if self.state=="normal" else (self.width/1.2,self.height/1.25) 
                    radius:[30]
            on_press:
                root.textbedisplay(self.text)
            disabled:root.is_disabled     
        Button:
            id:sym
            text:"<x]"
            canvas.before:
                Color:
                    rgb:(1, 0.784, 0.4, 1) if self.state=="down" else (1, 0.639, 0, 1)
                RoundedRectangle:
                    pos:(self.center_x-(self.width/2.34),self.center_y-(self.height/2.4)) if self.state=="down" else (self.center_x-(self.width/2.1),self.center_y-(self.height/2.3))
                    size:(self.width/1.1,self.height/1.15) if self.state=="normal" else (self.width/1.2,self.height/1.25) 
                    radius:[30]
            on_press:
                root.backspace()     
        Button:
            id:num
            text:"1"
            on_press:
                root.textbedisplay(self.text)
            disabled:root.is_disabled     
        Button:
            id:num
            text:"2"
            on_press:
                root.textbedisplay(self.text)
            disabled:root.is_disabled     
        Button:
            id:num
            text:"3"
            on_press:
                root.textbedisplay(self.text)
            disabled:root.is_disabled
        Button:
            id:sym
            text:"x"
            canvas.before:
                Color:
                    rgb:norm if self.state=="down" else (0.7,0.7,0.7,1)
                RoundedRectangle:
                    pos:(self.center_x-(self.width/2.34),self.center_y-(self.height/2.4)) if self.state=="down" else (self.center_x-(self.width/2.1),self.center_y-(self.height/2.3))
                    size:(self.width/1.1,self.height/1.15) if self.state=="normal" else (self.width/1.2,self.height/1.25) 
                    radius:[30]
            on_press:
                root.textbedisplay(self.text)
            disabled:root.is_disabled 
        Button:
            id:num
            text:"4"
            on_press:
                root.textbedisplay(self.text)
            disabled:root.is_disabled 
        Button:
            id:num
            text:"5"
            on_press:
                root.textbedisplay(self.text)
            disabled:root.is_disabled 
        Button:
            id:num
            text:"6"
            on_press:
                root.textbedisplay(self.text)
            disabled:root.is_disabled  
        Button:
            id:sym
            text:"/"
            canvas.before:
                Color:
                    rgb:norm if self.state=="down" else (0.7,0.7,0.7,1)
                RoundedRectangle:
                    pos:(self.center_x-(self.width/2.34),self.center_y-(self.height/2.4)) if self.state=="down" else (self.center_x-(self.width/2.1),self.center_y-(self.height/2.3))
                    size:(self.width/1.1,self.height/1.15) if self.state=="normal" else (self.width/1.2,self.height/1.25) 
                    radius:[30]
            on_press:
                root.textbedisplay(self.text)
            disabled:root.is_disabled  
        Button:
            id:num
            text:"7"
            on_press:
                root.textbedisplay(self.text)
            disabled:root.is_disabled     
        Button:
            id:num
            text:"8"
            on_press:
                root.textbedisplay(self.text)
            disabled:root.is_disabled  
        Button:
            id:num
            text:"9"
            on_press:
                root.textbedisplay(self.text)
            disabled:root.is_disabled     
        Button:
            id:sym
            text:"-"
            canvas.before:
                Color:
                    rgb:norm if self.state=="down" else (0.7,0.7,0.7,1)
                RoundedRectangle:
                    pos:(self.center_x-(self.width/2.34),self.center_y-(self.height/2.4)) if self.state=="down" else (self.center_x-(self.width/2.1),self.center_y-(self.height/2.3))
                    size:(self.width/1.1,self.height/1.15) if self.state=="normal" else (self.width/1.2,self.height/1.25) 
                    radius:[30]
            on_press:
                root.textbedisplay(self.text)
            disabled:root.is_disabled  
        Button:
            id:num
            text:"."
            canvas.before:
                Color:
                    rgb:norm if self.state=="down" else (0.7,0.7,0.7,1)
                RoundedRectangle:
                    pos:(self.center_x-(self.width/2.34),self.center_y-(self.height/2.4)) if self.state=="down" else (self.center_x-(self.width/2.1),self.center_y-(self.height/2.3))
                    size:(self.width/1.1,self.height/1.15) if self.state=="normal" else (self.width/1.2,self.height/1.25) 
                    radius:[30]
            on_press:
                root.textbedisplay(self.text)
            disabled:root.is_disabled 
        Button:
            id:num
            text:"0"
            on_press:
                root.textbedisplay(self.text)  
            disabled:root.is_disabled  
        Button:
            id:sym
            text:"+"
            canvas.before:
                Color:
                    rgb:norm if self.state=="down" else (0.7,0.7,0.7,1)
                RoundedRectangle:
                    pos:(self.center_x-(self.width/2.34),self.center_y-(self.height/2.4)) if self.state=="down" else (self.center_x-(self.width/2.1),self.center_y-(self.height/2.3))
                    size:(self.width/1.1,self.height/1.15) if self.state=="normal" else (self.width/1.2,self.height/1.25) 
                    radius:[30]
            on_press:
                root.textbedisplay(self.text)   
            disabled:root.is_disabled 
        Button:
            id:sym
            text:"="
            canvas.before:
                Color:
                    rgb:(1, 0.784, 0.4, 1) if self.state=="down" else (1, 0.639, 0, 1)
                RoundedRectangle:
                    pos:(self.center_x-(self.width/2.34),self.center_y-(self.height/2.4)) if self.state=="down" else (self.center_x-(self.width/2.1),self.center_y-(self.height/2.3))
                    size:(self.width/1.1,self.height/1.15) if self.state=="normal" else (self.width/1.2,self.height/1.25) 
                    radius:[30]
            on_press:
                root.textbedisplay(self.text)
            disabled:root.is_disabled                          